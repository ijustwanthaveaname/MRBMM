% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bmm_wrapper.R
\name{run_bmm_analysis}
\alias{run_bmm_analysis}
\title{Run BMM Analysis}
\usage{
run_bmm_analysis(
  beta_X,
  beta_Y,
  se_X,
  se_Y,
  rho_e = 0,
  compiled_models = NULL,
  n_chains = 1,
  iter = 1000,
  warmup = 200,
  use_weighted_mode = TRUE,
  use_parallel = FALSE,
  ...
)
}
\arguments{
\item{beta_X}{Numeric vector of SNP-exposure associations}

\item{beta_Y}{Numeric vector of SNP-outcome associations}

\item{se_X}{Numeric vector of standard errors for beta_X}

\item{se_Y}{Numeric vector of standard errors for beta_Y}

\item{rho_e}{Numeric scalar, sample overlap correlation (default: 0)}

\item{compiled_models}{List with compiled Stan models from compile_stan_models()}

\item{n_chains}{Integer, number of MCMC chains (default: 4)}

\item{iter}{Integer, total iterations per chain (default: 1000)}

\item{warmup}{Integer, warmup iterations (default: 200)}

\item{use_weighted_mode}{Logical, use Weighted Mode initialization (default: TRUE)}

\item{use_parallel}{Logical, run models in parallel (default: TRUE)}

\item{...}{Additional arguments passed to run_mr_model_comparison()}
}
\value{
Object of class 'bmm_result' with analysis results
}
\description{
Wrapper for run_mr_model_comparison() from bmm_core.R
Performs complete Bayesian mixture model analysis with 3/4-component
model comparison and automatic model selection.
}
\details{
This function performs:
\enumerate{
  \item Fits 3-component model (Valid, Valid+UHP, NULL/UHP)
  \item Fits 4-component model (Valid, Valid+UHP, Valid+UHP+CHP, NULL)
  \item Compares models via LOO-CV
  \item Selects best model
  \item Returns final inference
}

IMPORTANT: Set Sys.setenv(TBB_CXX_TYPE = "gcc") before running.
}
\examples{
\dontrun{
# Set environment
Sys.setenv(TBB_CXX_TYPE = "gcc")

# Compile models
compiled <- compile_stan_models()

# Run analysis
results <- run_bmm_analysis(
  beta_X = harmonized_data$beta_X,
  beta_Y = harmonized_data$beta_Y,
  se_X = harmonized_data$se_X,
  se_Y = harmonized_data$se_Y,
  rho_e = 0,
  compiled_models = compiled
)

# View results
summary(results)
}

}
\seealso{
\code{\link{compile_stan_models}}, \code{\link{harmonize_for_mr}}
}
